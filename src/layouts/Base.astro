---
interface Props {
  title: string;
  description?: string;
  image?: string;
}

const { 
  title, 
  description = "A Cognitive Commons Architecture for Human-AI Collaboration. Your expertise becomes equity.",
  image = "/og-image.png"
} = Astro.props;

const currentPath = Astro.url.pathname;
const canonicalURL = new URL(currentPath, Astro.site);
const ogImageURL = new URL(image, Astro.site);

const navLinks = [
  { href: '/', label: 'Home' },
  { href: '/vision', label: 'Vision' },
  { href: '/how-it-works', label: 'How It Works' },
  { href: '/economics', label: 'Economics' },
  { href: '/node', label: 'Node' },
];

const siteName = "Synthesis";
const twitterHandle = "@amotivv";
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Primary Meta Tags -->
    <title>{title} | {siteName}</title>
    <meta name="title" content={`${title} | ${siteName}`} />
    <meta name="description" content={description} />
    <meta name="author" content="amotivv, inc." />
    <meta name="keywords" content="AI collaboration, cognitive commons, human-AI partnership, knowledge economy, memory packs, expertise equity" />
    
    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalURL} />
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={`${title} | ${siteName}`} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImageURL} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="Synthesis - A Cognitive Commons Architecture" />
    <meta property="og:site_name" content={siteName} />
    <meta property="og:locale" content="en_US" />
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonicalURL} />
    <meta name="twitter:title" content={`${title} | ${siteName}`} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImageURL} />
    <meta name="twitter:image:alt" content="Synthesis - A Cognitive Commons Architecture" />
    <meta name="twitter:site" content={twitterHandle} />
    <meta name="twitter:creator" content={twitterHandle} />
    
    <!-- Additional SEO -->
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow" />
    <meta name="theme-color" content="#f59e0b" />
    <meta name="msapplication-TileColor" content="#f59e0b" />
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
    
    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": siteName,
      "description": description,
      "url": Astro.site,
      "publisher": {
        "@type": "Organization",
        "name": "amotivv, inc.",
        "url": "https://amotivv.com"
      }
    })} />
    
    <!-- Theme initialization -->
    <script is:inline>
      const theme = localStorage.getItem('theme') || 'light';
      if (theme === 'dark') {
        document.documentElement.classList.add('dark');
      }
    </script>
  </head>
  
  <body class="min-h-screen">
    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 bg-white/90 dark:bg-synthesis-950/90 backdrop-blur-md border-b border-synthesis-100 dark:border-synthesis-900">
      <div class="container-wide">
        <div class="flex items-center justify-between h-14 sm:h-16">
          <!-- Logo - text style with dot -->
          <a href="/" class="group">
            <span class="text-xl sm:text-2xl font-semibold tracking-tight text-synthesis-900 dark:text-synthesis-100 group-hover:text-synthesis-700 dark:group-hover:text-synthesis-300 transition-colors">synthesis<span class="text-amber-500">.</span></span>
          </a>
          
          <!-- Desktop Nav -->
          <div class="hidden md:flex items-center gap-6 lg:gap-8">
            {navLinks.map(link => (
              <a 
                href={link.href}
                class:list={[
                  "text-sm lg:text-base font-medium transition-colors",
                  currentPath === link.href 
                    ? "text-amber-500" 
                    : "text-synthesis-600 dark:text-synthesis-400 hover:text-synthesis-900 dark:hover:text-synthesis-200"
                ]}
              >
                {link.label}
              </a>
            ))}
            
            <!-- Theme Toggle -->
            <button 
              id="theme-toggle"
              class="p-2 rounded-md text-synthesis-500 dark:text-synthesis-400 hover:text-synthesis-700 dark:hover:text-synthesis-200 hover:bg-synthesis-100 dark:hover:bg-synthesis-800 transition-colors"
              aria-label="Toggle theme"
            >
              <svg class="w-5 h-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
              </svg>
              <svg class="w-5 h-5 block dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
              </svg>
            </button>
          </div>
          
          <!-- Mobile controls -->
          <div class="flex items-center gap-1 md:hidden">
            <button 
              id="theme-toggle-mobile"
              class="p-2.5 text-synthesis-500 dark:text-synthesis-400"
              aria-label="Toggle theme"
            >
              <svg class="w-5 h-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
              </svg>
              <svg class="w-5 h-5 block dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
              </svg>
            </button>
            
            <button 
              id="mobile-menu-btn"
              class="p-2.5 text-synthesis-500 dark:text-synthesis-400"
              aria-label="Toggle menu"
            >
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
              </svg>
            </button>
          </div>
        </div>
      </div>
      
      <!-- Mobile menu -->
      <div id="mobile-menu" class="hidden md:hidden border-t border-synthesis-100 dark:border-synthesis-900 bg-white/95 dark:bg-synthesis-950/95 backdrop-blur-md">
        <div class="container-wide py-4 flex flex-col gap-1">
          {navLinks.map(link => (
            <a 
              href={link.href}
              class:list={[
                "px-4 py-3 rounded-lg text-base font-medium transition-colors",
                currentPath === link.href 
                  ? "text-amber-500 bg-amber-50 dark:bg-amber-900/20" 
                  : "text-synthesis-600 dark:text-synthesis-400 active:bg-synthesis-50 dark:active:bg-synthesis-900"
              ]}
            >
              {link.label}
            </a>
          ))}
        </div>
      </div>
    </nav>
    
    <!-- Main content -->
    <main class="pt-14 sm:pt-16">
      <slot />
    </main>
    
    <!-- Footer -->
    <footer class="border-t border-synthesis-100 dark:border-synthesis-900 mt-12 sm:mt-16">
      <div class="container-wide py-8 sm:py-10">
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-6 sm:gap-4">
          <div class="flex items-center gap-2">
            <span class="text-lg font-semibold tracking-tight text-synthesis-700 dark:text-synthesis-300">synthesis<span class="text-amber-500">.</span></span>
            <span class="text-sm sm:text-base text-synthesis-400">
              Â· amotivv, inc.
            </span>
          </div>
          
          <div class="flex flex-wrap gap-4 sm:gap-6 text-sm sm:text-base text-synthesis-500">
            {navLinks.slice(1).map(link => (
              <a href={link.href} class="hover:text-synthesis-700 dark:hover:text-synthesis-300 transition-colors">
                {link.label}
              </a>
            ))}
          </div>
        </div>
      </div>
    </footer>
    
    <script>
      document.getElementById('mobile-menu-btn')?.addEventListener('click', () => {
        document.getElementById('mobile-menu')?.classList.toggle('hidden');
      });
    </script>
    
    <script>
      function toggleTheme() {
        const html = document.documentElement;
        if (html.classList.contains('dark')) {
          html.classList.remove('dark');
          localStorage.setItem('theme', 'light');
        } else {
          html.classList.add('dark');
          localStorage.setItem('theme', 'dark');
        }
      }
      document.getElementById('theme-toggle')?.addEventListener('click', toggleTheme);
      document.getElementById('theme-toggle-mobile')?.addEventListener('click', toggleTheme);
    </script>
    
    <script>
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
          }
        });
      }, { threshold: 0.1 });
      document.querySelectorAll('.fade-section').forEach(el => observer.observe(el));
    </script>
  </body>
</html>

<style is:global>
  @import '../styles/global.css';
</style>
